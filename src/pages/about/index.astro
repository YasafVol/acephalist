---
import { getCollection } from "astro:content"
import PageLayout from "@layouts/PageLayout.astro"
import TopLayout from "@layouts/TopLayout.astro"
import BottomLayout from "@layouts/BottomLayout.astro"
import ImageCompare from "@components/ImageCompare.astro"
import { ABOUT } from "@consts"

const work = await getCollection("work")

work.sort((a, b) => new Date(b.data.dateStart).getTime() - new Date(a.data.dateStart).getTime())

const workItems = await Promise.all(
  work.map(async (item) => {
    const { Content } = await item.render()
    return { ...item, Content }
  })
)

function formatWorkDate(input: Date | string) {
  if (typeof input === "string") return input

  const month = input.toLocaleDateString("en-US", {
    month: "short",
  })

  const year = new Date(input).getFullYear()
  return `${month} ${year}`
}
---

<PageLayout title={ABOUT.TITLE} description={ABOUT.DESCRIPTION}>
  <TopLayout>
    <div class="animate page-heading">
      {ABOUT.TITLE}
    </div>
  </TopLayout>
  <BottomLayout>
    <!-- Image Comparison Section -->
    <section class="animate">
      <div class="space-y-4">
        <h2 class="text-2xl font-semibold text-black dark:text-white mb-4">
          Visual Representations
        </h2>
        <p class="text-black/75 dark:text-white/75 mb-8">
          A visual journey through different representations of myself - from digital avatar to artistic interpretation.
        </p>
        <ImageCompare
          beforeSrc="/images/yasafVolDnD.png"
          afterSrc="/images/yasafVolDrawn.png"
          alt="Yasaf - D&D character vs drawn version"
          width={500}
          labelText="Drag slider to compare my D&D character vs drawn version"
        />
      </div>
    </section>

    <!-- About Content Section -->
    <section class="animate mt-12">
      <div class="space-y-4">
        <h2 class="text-2xl font-semibold text-black dark:text-white mb-4">
          About Me
        </h2>
        <div class="prose prose-lg max-w-none dark:prose-invert">
          <p>I am a <strong><i>software engineer</i></strong>, <strong><i>ui/ux designer</i></strong>, <strong><i>product planner</i></strong>, <strong><i>mentor</i></strong>, <strong><i>student</i></strong>, <strong><i>minimalist</i></strong>, <strong><i>eternal optimist</i></strong>, <strong><i>crypto enthusiast</i></strong> and <strong><i>sarcasm connoisseur</i></strong>.</p>
          <p>I love to both build and break things. I am motivated by challenging projects with self-guided research and dynamic problem solving. My true passion is crafting creative front end designs with unique takes on color, typography and motion.</p>
          <p>During my career</p>
          <p>I have built products ranging from marketing and ecommerce websites to complex enterprise apps with focus on delivering fast, elegant code along with delightful user interfaces.</p>
          <p>Now</p>
          <p>I currently work as a software engineer at StreamlineFS, where I do product planning, design and development.</p>
          <blockquote class="border-l-4 border-black/25 dark:border-white/25 pl-4 italic my-4 text-black/75 dark:text-white/75">
            <p>"It's what I do, I drink, and I know things." - Tyrion Lannister</p>
          </blockquote>
        </div>
      </div>
    </section>

    <!-- Work Experience Section -->
    <section class="animate mt-12">
      <div class="space-y-4">
        <h2 class="text-2xl font-semibold text-black dark:text-white mb-4">
          Professional Journey
        </h2>
        <p class="text-black/75 dark:text-white/75">
          My career progression and professional experience.
        </p>
      </div>
    </section>

    <!-- Work Timeline -->
    <ul>
      {
        workItems.map((entry) => (
          <li class="animate border-b border-black/10 dark:border-white/25 mt-4 py-8 first-of-type:mt-0 first-of-type:pt-0 last-of-type:border-none">
            <div class="text-sm uppercase mb-4">
              {formatWorkDate(entry.data.dateStart)} - {formatWorkDate(entry.data.dateEnd)}
            </div>
            <div class="text-black dark:text-white font-semibold">
              {entry.data.company}
            </div>
            <div class="text-sm font-semibold">
              {entry.data.role}
            </div>
            <article class="prose dark:prose-invert mt-4">
              <entry.Content />
            </article>
          </li>
        ))
      }
    </ul>
  </BottomLayout>
</PageLayout>

<style>
  .prose {
    @apply text-black dark:text-white leading-relaxed;
  }

  .prose h2 {
    @apply text-xl font-semibold mt-6 mb-3;
  }

  .prose p {
    @apply mb-4;
  }

  .prose strong {
    @apply font-semibold;
  }

  .prose em {
    @apply italic;
  }

  .prose blockquote {
    @apply border-l-4 border-black/25 dark:border-white/25 pl-4 italic my-4;
  }
</style>
